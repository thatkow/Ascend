<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ascend</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="shared/page-loader.css" />
    <link rel="stylesheet" href="personal.css" />
  </head>
  <body>
    <div id="pageLoader" class="page-loader" role="status" aria-live="polite">
      <img src="banner.png" alt="Ascend" />
    </div>
    <div id="authOverlay" class="auth-overlay" role="dialog" aria-modal="true" aria-labelledby="authTitle">
      <form id="authForm" class="auth-card">
        <h1 id="authTitle">Sign in to continue</h1>
        <label class="auth-field">
          <span>Username</span>
          <input id="authUsername" type="text" name="username" autocomplete="username" required />
        </label>
        <label class="auth-field">
          <span>Password</span>
          <input id="authPassword" type="password" name="password" autocomplete="current-password" minlength="6" required />
        </label>
        <p id="authError" class="auth-error" role="alert" aria-live="assertive"></p>
        <button type="submit" class="auth-submit">Sign In</button>
        <p class="auth-switch">
          <span id="authSwitchLabel">Don't have an account?</span>
          <button type="button" id="toggleAuthMode">Create one</button>
        </p>
      </form>
    </div>
    <div id="appContent" class="app hidden" aria-live="polite">
      <div class="info-wrapper">
        <button
          id="infoButton"
          class="header-icon-button info-button"
          type="button"
          aria-label="Learn about Ascend"
          aria-haspopup="dialog"
          aria-pressed="false"
          aria-expanded="false"
          aria-controls="infoPopover"
          title="Learn about Ascend"
        >
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2" />
            <rect x="11" y="10" width="2" height="7" rx="1" />
            <circle cx="12" cy="7" r="1.5" />
          </svg>
        </button>
        <div
          id="infoPopover"
          class="info-popover hidden"
          role="dialog"
          aria-modal="false"
          aria-hidden="true"
          aria-label="About Ascend"
          tabindex="-1"
        >
          <p>Tap a header button to learn what it does.</p>
          <p>The next button you press will open its tooltip and close this message.</p>
          <div class="info-popover-actions">
            <button id="startPersonalTutorialButton" class="info-popover-button" type="button">
              Take the personal tour
            </button>
          </div>
        </div>
      </div>
      <header class="app-header">
        <div
          id="viewToggleGroup"
          class="view-mode-toggle-group"
          role="group"
          aria-label="Route coloring mode"
        >
          <button
            type="button"
            id="viewModeCycleButton"
            class="header-icon-button view-toggle-option"
            data-view-mode="hold-colors"
            data-view-mode-cycle="ascent-status grade-colors hold-colors"
            data-tooltip="Showing by Color of Holds"
            aria-pressed="true"
            aria-label="Showing by Color of Holds"
            title="Showing by Color of Holds"
          >
            <span class="sr-only" data-view-toggle-label>Showing by Color of Holds</span>
            <span class="view-toggle-icon view-toggle-icon--ascents" aria-hidden="true">
              <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
                <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2" />
                <path
                  d="m9.2 12.8 2.1 2.1 4.5-5.6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </span>
            <span class="view-toggle-icon view-toggle-icon--grades" aria-hidden="true">
              <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
                <rect x="5" y="13.5" width="3.5" height="6" rx="1.75" fill="#2f9e44" />
                <rect x="10.25" y="9.5" width="3.5" height="10" rx="1.75" fill="#facc15" />
                <rect x="15.5" y="5" width="3.5" height="14.5" rx="1.75" fill="#ef4444" />
                <rect x="4" y="20" width="16" height="1.5" rx="0.75" fill="#ffffff" fill-opacity="0.55" />
              </svg>
            </span>
            <span class="view-toggle-icon view-toggle-icon--holds" aria-hidden="true">
              <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
                <path
                  d="M6 19a3 3 0 0 1 0-6h12a2 2 0 0 0 0-4H8a4 4 0 0 1 0-8h10v2H8a2 2 0 0 0 0 4h10a4 4 0 0 1 0 8H6a1 1 0 0 0 0 2h12v2H6a3 3 0 0 1-3-3Z"
                  fill="currentColor"
                />
              </svg>
            </span>
          </button>
        </div>
        <button
          id="progressionButton"
          class="header-icon-button progression-button"
          type="button"
          aria-haspopup="dialog"
          aria-expanded="false"
          aria-label="View progression"
          title="View progression"
        >
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M4 4a1 1 0 0 1 1-1h1.5a1 1 0 0 1 0 2H6v14h15v2H5a1 1 0 0 1-1-1V4Z" fill="currentColor" />
            <path
              d="m10.2 12.8 2.3 2.3 5.2-5.2a1 1 0 0 1 1.4 1.4l-5.9 5.9a1 1 0 0 1-1.4 0l-3-3a1 1 0 0 1 1.4-1.4Z"
              fill="currentColor"
            />
          </svg>
        </button>
        <a
          id="setterLink"
          class="header-icon-button setter-link hidden"
          href="setter.html"
          aria-label="Open setter tools"
          title="Open setter tools"
        >
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path
              d="M10.5 4.5a3 3 0 0 1 3.87 2.88l3.13 3.12-2.12 2.13-3.13-3.13a3 3 0 1 1-4.75-3.44l2.12 2.12 1.41-1.41Z"
              fill="currentColor"
            />
            <path
              d="M6.34 14.34 9.66 17.66a2 2 0 0 1 0 2.83l-.83.83a2 2 0 0 1-2.83 0L2.68 17.2a1 1 0 0 1 0-1.41l2.25-2.25a1 1 0 0 1 1.41 0Z"
              fill="currentColor"
            />
          </svg>
        </a>
        <button
          id="locationButton"
          class="header-icon-button walls-button"
          type="button"
          aria-haspopup="dialog"
          aria-label="Select wall"
          title="Select wall"
        >
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path
              d="M12 2a7 7 0 0 1 7 7c0 4.42-4.56 9.52-6.38 11.34a0.88 0.88 0 0 1-1.24 0C9.56 18.52 5 13.42 5 9a7 7 0 0 1 7-7Zm0 4a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"
              fill="currentColor"
            />
          </svg>
        </button>
        <button
          id="signOutButton"
          class="header-icon-button sign-out"
          type="button"
          aria-label="Sign out"
          title="Sign out"
        >
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path
              d="M13 4a1 1 0 0 1 1-1h6v18h-6a1 1 0 0 1-1-1V4Zm-2.29 4.29 1.42 1.42L9.83 12l2.3 2.29-1.42 1.42L6 12l4.71-3.71Z"
              fill="currentColor"
            />
          </svg>
        </button>
      </header>
      <div class="canvas-container">
        <canvas id="previewCanvas" aria-hidden="true"></canvas>
        <div class="focus-footer">
          <button
            id="clearFocusButton"
            class="clear-focus-button hidden"
            type="button"
            data-info-target="route-focus"
            aria-hidden="true"
          >
            Clear Focus
          </button>
        </div>
      </div>
    </div>
    <div
      id="routeTooltip"
      class="route-tooltip"
      role="status"
      aria-live="polite"
      aria-hidden="true"
    ></div>
    <div
      id="routeOverlapPrompt"
      class="route-overlap-prompt hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="routeOverlapTitle"
    >
      <div class="route-overlap-card" role="document">
        <div class="route-overlap-header">
          <h2 id="routeOverlapTitle" class="route-overlap-title">Select a route</h2>
          <button
            id="routeOverlapClose"
            class="route-overlap-close"
            type="button"
            aria-label="Close route selection dialog"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path
                d="M6.7 6.7a1 1 0 0 1 1.4 0L12 10.6l3.9-3.9a1 1 0 0 1 1.4 1.4L13.4 12l3.9 3.9a1 1 0 0 1-1.4 1.4L12 13.4l-3.9 3.9a1 1 0 0 1-1.4-1.4L10.6 12 6.7 8.1a1 1 0 0 1 0-1.4Z"
                fill="currentColor"
              />
            </svg>
          </button>
        </div>
        <p class="route-overlap-description">Multiple routes share this start. Choose one to focus.</p>
        <ul id="routeOverlapList" class="route-overlap-list" role="listbox"></ul>
      </div>
    </div>
    <div
      id="progressionModal"
      class="progression-modal hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="progressionModalTitle"
    >
      <div class="progression-modal-content">
        <div class="progression-modal-header">
          <h2 id="progressionModalTitle" class="progression-modal-title">Progression</h2>
          <button
            id="progressionModalClose"
            class="progression-modal-close"
            type="button"
            aria-label="Close progression"
            title="Close progression"
          >
            ×
          </button>
        </div>
        <p class="progression-description">
          Track your climbs at a glance. Routes are sorted by their grade number with ascended climbs
          highlighted.
        </p>
        <div id="progressionList" class="progression-list" role="list"></div>
      </div>
    </div>
    <div
      id="locationModal"
      class="location-modal hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="locationModalTitle"
    >
      <div class="location-modal-content">
        <div class="location-modal-header">
          <h2 id="locationModalTitle" class="location-modal-title">Select a wall</h2>
          <button id="locationModalClose" class="location-modal-close" type="button" aria-label="Close wall selector">
            ×
          </button>
        </div>
        <div id="locationOptions" class="location-options" role="listbox"></div>
      </div>
    </div>
    <div
      id="tutorialOverlay"
      class="tutorial-overlay hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="tutorialTitle"
      aria-describedby="tutorialDescription"
      data-tutorial-exempt="true"
    >
      <div id="tutorialDialogCard" class="tutorial-card" role="document" tabindex="-1">
        <div id="tutorialProgress" class="tutorial-progress hidden" aria-live="polite"></div>
        <h2 id="tutorialTitle" class="tutorial-title"></h2>
        <div id="tutorialBrand" class="tutorial-brand hidden" aria-hidden="true">
          <img src="banner.png" alt="Ascend banner" class="tutorial-brand-image" />
        </div>
        <div id="tutorialDescription" class="tutorial-description"></div>
        <div class="tutorial-actions">
          <button
            id="tutorialSecondaryAction"
            class="tutorial-button tutorial-secondary hidden"
            type="button"
            data-tutorial-exempt="true"
          >
            Back
          </button>
          <button
            id="tutorialPrimaryAction"
            class="tutorial-button tutorial-primary"
            type="button"
            data-tutorial-exempt="true"
          >
            Next
          </button>
        </div>
      </div>
    </div>
    <script defer src="shared/page-loader.js"></script>
    <script type="module" src="personal.js"></script>
  </body>
</html>
