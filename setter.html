<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ascend</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="shared/page-loader.css" />
  <link rel="stylesheet" href="setter.css" />
</head>
<body>
  <div id="pageLoader" class="page-loader" role="status" aria-live="polite">
    <img src="banner.png" alt="Ascend" />
  </div>
  <div id="authOverlay" class="auth-overlay" role="dialog" aria-modal="true" aria-labelledby="authTitle">
    <form id="authForm" class="auth-card">
      <h1 id="authTitle">Sign in to continue</h1>
      <label class="auth-field">
        <span>Username</span>
        <input id="authUsername" type="text" name="username" autocomplete="username" required />
      </label>
      <label class="auth-field">
        <span>Password</span>
        <input id="authPassword" type="password" name="password" autocomplete="current-password" minlength="6" required />
      </label>
      <p id="authError" class="auth-error" role="alert" aria-live="assertive"></p>
      <button type="submit" class="auth-submit">Sign In</button>
      <p class="auth-switch">
        <span id="authSwitchLabel">Don't have an account?</span>
        <button type="button" id="toggleAuthMode">Create one</button>
      </p>
    </form>
  </div>

  <div id="appContent" class="hidden">
    <a
      class="personal-dashboard-link"
      href="personal.html"
      aria-label="Open personal dashboard"
    >
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path
          d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4.41 0-8 2.24-8 5v1h16v-1c0-2.76-3.59-5-8-5Z"
          fill="currentColor"
        />
      </svg>
      <span class="sr-only">Open personal dashboard</span>
    </a>
    <div class="canvas-container">
      <canvas id="drawingCanvas"></canvas>
    </div>
    <div class="control-panel" data-expanded="true">
      <div id="panelSidebar" class="panel-sidebar">
        <div class="sidebar-actions">
          <button
            id="panelToggle"
            class="panel-icon-button panel-toggle-button"
            type="button"
            aria-pressed="false"
            aria-label="Hide menu"
            title="Hide menu"
          >
            <span class="panel-toggle-icon panel-toggle-icon-close" aria-hidden="true">
              <svg viewBox="0 0 24 24" focusable="false">
                <path
                  d="M6.34 6.34a1 1 0 0 1 1.32-.08l.1.08L12 10.59l4.24-4.25a1 1 0 0 1 1.5 1.32l-.08.1L13.41 12l4.25 4.24a1 1 0 0 1-1.32 1.5l-.1-.08L12 13.41l-4.24 4.25a1 1 0 0 1-1.5-1.32l.08-.1L10.59 12 6.34 7.76a1 1 0 0 1 0-1.42Z"
                  fill="currentColor"
                />
              </svg>
            </span>
            <span class="panel-toggle-icon panel-toggle-icon-open" aria-hidden="true">
              <svg viewBox="0 0 24 24" focusable="false">
                <path
                  d="M9.29 5.29a1 1 0 0 1 1.42 0l5 5a1 1 0 0 1 .08 1.32l-.08.1-5 5a1 1 0 0 1-1.5-1.32l.08-.1L13.59 12 9.3 7.7a1 1 0 0 1-.08-1.32Z"
                  fill="currentColor"
                />
              </svg>
            </span>
            <span class="sr-only">Hide menu</span>
          </button>
          <div class="info-wrapper">
            <button
              id="infoButton"
              class="panel-icon-button info-button"
              type="button"
              aria-label="Learn about setter tools"
              aria-haspopup="dialog"
              aria-pressed="false"
              aria-expanded="false"
              aria-controls="infoPopover"
              title="Learn about setter tools"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2" />
                <rect x="11" y="10" width="2" height="7" rx="1" />
                <circle cx="12" cy="7" r="1.5" />
              </svg>
              <span class="sr-only">Learn about setter tools</span>
            </button>
            <div
              id="infoPopover"
              class="info-popover hidden"
              role="dialog"
              aria-modal="false"
              aria-hidden="true"
              aria-label="About Ascend"
              tabindex="-1"
            >
              <p>Select any setter control to learn what it does.</p>
              <p>The next control you activate will show its tooltip and close this message.</p>
              <div class="info-popover-actions">
                <button id="startTutorialButton" class="info-popover-button" type="button">
                  Take the setter tour
                </button>
              </div>
            </div>
          </div>
          <button
            id="drawingToggle"
            class="panel-icon-button drawing-toggle"
            type="button"
            aria-pressed="false"
            aria-label="Enable drawing"
            title="Enable drawing"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path
                d="M4 15.75V20h4.25l11.1-11.1a1 1 0 0 0 0-1.42L17.52 5.65a1 1 0 0 0-1.41 0L4 17.66Z"
                fill="currentColor"
              />
              <path d="m16.08 4.22 3.7 3.7 1.41-1.41a1 1 0 0 0 0-1.42l-2.28-2.28a1 1 0 0 0-1.42 0l-1.41 1.41Z" fill="currentColor" />
            </svg>
            <span class="sr-only">Enable drawing</span>
          </button>
        </div>
        <div
          id="panelTablist"
          class="panel-tablist"
          role="tablist"
          aria-orientation="vertical"
          aria-label="Setter controls"
        >
          <button
            id="routesTabButton"
            class="panel-icon-button panel-tab"
            type="button"
            role="tab"
            aria-selected="true"
            aria-controls="routesTab"
            data-target="routesTab"
            aria-label="Routes"
            title="Routes"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path
                d="M6 19a3 3 0 0 1 0-6h12a2 2 0 0 0 0-4H8a4 4 0 0 1 0-8h10v2H8a2 2 0 0 0 0 4h10a4 4 0 0 1 0 8H6a1 1 0 0 0 0 2h12v2H6a3 3 0 0 1-3-3Z"
                fill="currentColor"
              />
            </svg>
            <span class="sr-only">Routes</span>
          </button>
          <button
            id="wallsTabButton"
            class="panel-icon-button panel-tab"
            type="button"
            role="tab"
            aria-selected="false"
            aria-controls="wallsTab"
            data-target="wallsTab"
            aria-label="Walls"
            title="Walls"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path
                d="M12 2a7 7 0 0 1 7 7c0 4.42-4.56 9.52-6.38 11.34a0.88 0.88 0 0 1-1.24 0C9.56 18.52 5 13.42 5 9a7 7 0 0 1 7-7Zm0 4a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"
                fill="currentColor"
              />
            </svg>
            <span class="sr-only">Walls</span>
          </button>
          <button
            id="configurationTabButton"
            class="panel-icon-button panel-tab"
            type="button"
            role="tab"
            aria-selected="false"
            aria-controls="configurationTab"
            data-target="configurationTab"
            aria-label="Configuration"
            title="Configuration"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path
                d="M21.53 14.47 18 10.94V7.5a1 1 0 0 0-1-1h-3.44L11 3.94a2 2 0 0 0-2.83 0L7 5.12a1 1 0 0 0 0 1.41l2.83 2.83-6.72 6.72a2 2 0 0 0 0 2.83l1.41 1.41a2 2 0 0 0 2.83 0l6.72-6.72 2.83 2.83a1 1 0 0 0 1.41 0l1.18-1.18a2 2 0 0 0 .04-2.78Z"
                fill="currentColor"
              />
            </svg>
            <span class="sr-only">Configuration</span>
          </button>
        </div>
      </div>
      <div id="controlsPanel" class="controls">
        <div class="tab-panels">
          <div
            id="routesTab"
            class="tab-panel"
            role="tabpanel"
            aria-labelledby="routesTabButton"
            aria-hidden="false"
          >
            <div class="control-section">
              <label class="control-field" data-help-text="Select a saved route to edit or choose the new option to start fresh.">
                <span>Saved routes</span>
                <select id="routeSelector">
                  <option value="">Create new route‚Ä¶</option>
                </select>
              </label>
              <label class="control-field" data-help-text="Enter the setter name that should appear to climbers.">
                <span>Setter</span>
                <input id="routeSetterInput" type="text" placeholder="setter name" autocomplete="off" />
              </label>
              <label class="control-field" data-help-text="Provide a clear title that climbers will see in the list.">
                <span>Title</span>
                <input id="routeTitleInput" type="text" placeholder="Route title" autocomplete="off" />
              </label>
              <label class="control-field" data-help-text="Add beta notes or important information about the climb.">
                <span>Description</span>
                <textarea id="routeDescriptionInput" placeholder="Describe the climb"></textarea>
              </label>
              <label class="control-field" data-help-text="Record when the route was set to manage rotations.">
                <span>Date set</span>
                <input id="routeDateSetInput" type="datetime-local" />
              </label>
              <label
                class="control-toggle"
                data-help-text="Temporarily hide this route from the climber and personal pages without deleting it."
              >
                <span>Hide route from climbers</span>
                <input id="routeHiddenCheckbox" type="checkbox" role="switch" aria-checked="false" />
              </label>
            </div>
            <div class="control-section">
              <label class="control-field" data-help-text="Choose the colour used to draw this route on the wall preview.">
                <span>Stroke colour</span>
                <input type="color" id="colorPicker" value="#ffde59" />
              </label>
              <label class="control-field" data-help-text="Switch between freeform lines, hollow points, filled points, or rectangles while drawing.">
                <span>Path</span>
                <select id="pathTypeSelect">
                  <option value="bezier">Bezier</option>
                  <option value="hollow-point">Hollow point</option>
                  <option value="filled-point">Filled point</option>
                  <option value="rectangle">Rectangle</option>
                </select>
              </label>
              <button
                id="advancedColorToggle"
                class="color-wheel-toggle"
                type="button"
                aria-expanded="false"
                aria-controls="advancedColorPicker"
                data-help-text="Open the colour wheel to fine tune hue, saturation, and brightness."
              >
                Open colour wheel
              </button>
              <div
                id="advancedColorPicker"
                class="color-wheel hidden"
                aria-hidden="true"
                data-help-text="Drag in the wheel or adjust the slider to refine the stroke colour."
              >
                <div class="color-wheel-canvas-wrapper">
                  <canvas
                    id="colorWheelCanvas"
                    width="220"
                    height="220"
                    tabindex="0"
                    role="application"
                    aria-label="Colour wheel selector"
                    aria-describedby="colorWheelHint"
                  ></canvas>
                  <div id="colorWheelMarker" class="color-wheel-marker" aria-hidden="true"></div>
                </div>
                <p id="colorWheelHint" class="color-wheel-hint">
                  Drag on the wheel or use the arrow keys to adjust hue and saturation.
                </p>
                <div class="color-lightness-control" data-help-text="Use the slider to brighten or darken the selected colour.">
                  <label for="colorLightnessSlider">Lightness</label>
                  <input id="colorLightnessSlider" type="range" min="0" max="100" value="50" />
                </div>
                <div class="color-wheel-preview" aria-live="polite">
                  <div id="colorWheelSwatch" class="color-wheel-swatch" aria-hidden="true"></div>
                  <code id="colorWheelValue">#FFDE59</code>
                </div>
              </div>
              <button id="saveButton" type="button" data-help-text="Save the current drawing and route details.">Save route</button>
              <button id="deleteButton" type="button" data-help-text="Delete the selected route permanently.">Delete route</button>
              <button id="clearButton" type="button" data-help-text="Remove every drawn shape from the canvas.">Clear drawing</button>
            </div>
          </div>
          <div
            id="configurationTab"
            class="tab-panel"
            role="tabpanel"
            aria-labelledby="configurationTabButton"
            aria-hidden="true"
          >
            <div class="control-section">
              <h3 class="control-section-title">Appearance</h3>
              <label
                id="hollowPointDiameterField"
                class="control-field"
                data-help-text="Set the diameter for hollow point holds drawn on this wall."
              >
                <span>
                  Hollow point diameter
                  <span id="hollowPointDiameterValue"></span>
                </span>
                <input
                  id="hollowPointDiameterSlider"
                  type="range"
                  min="12"
                  max="160"
                  step="1"
                  value="48"
                />
              </label>
              <label
                id="filledPointDiameterField"
                class="control-field"
                data-help-text="Set the diameter for filled point holds drawn on this wall."
              >
                <span>
                  Filled point diameter
                  <span id="filledPointDiameterValue"></span>
                </span>
                <input
                  id="filledPointDiameterSlider"
                  type="range"
                  min="12"
                  max="160"
                  step="1"
                  value="48"
                />
              </label>
              <label
                id="filledPointTransparencyField"
                class="control-field"
                data-help-text="Adjust the opacity for filled point holds drawn on this wall."
              >
                <span>
                  Filled point transparency
                  <span id="filledPointTransparencyValue"></span>
                </span>
                <input
                  id="filledPointTransparencySlider"
                  type="range"
                  min="0"
                  max="100"
                  step="5"
                  value="100"
                />
              </label>
              <label
                id="hollowPointLineWidthField"
                class="control-field"
                data-help-text="Adjust the outline thickness used for hollow point holds."
              >
                <span>
                  Hollow point outline thickness
                  <span id="hollowPointLineWidthValue"></span>
                </span>
                <input
                  id="hollowPointLineWidthSlider"
                  type="range"
                  min="1"
                  max="48"
                  step="1"
                  value="5"
                />
              </label>
              <label
                id="rectangleWidthField"
                class="control-field"
                data-help-text="Adjust the width of rectangle holds when using the rectangle path."
              >
                <span>
                  Rectangle width
                  <span id="rectangleWidthValue"></span>
                </span>
                <input
                  id="rectangleWidthSlider"
                  type="range"
                  min="12"
                  max="200"
                  step="1"
                  value="80"
                />
              </label>
              <label
                id="rectangleHeightField"
                class="control-field"
                data-help-text="Adjust the height of rectangle holds when using the rectangle path."
              >
                <span>
                  Rectangle height
                  <span id="rectangleHeightValue"></span>
                </span>
                <input
                  id="rectangleHeightSlider"
                  type="range"
                  min="12"
                  max="200"
                  step="1"
                  value="60"
                />
              </label>
              <label
                id="bezierStrokeWidthField"
                class="control-field"
                data-help-text="Set the thickness of Bezier lines for freeform paths on this wall."
              >
                <span>
                  Bezier stroke width
                  <span id="bezierStrokeWidthValue"></span>
                </span>
                <input
                  id="bezierStrokeWidthSlider"
                  type="range"
                  min="2"
                  max="40"
                  step="1"
                  value="10"
                />
              </label>
              <label
                id="unfocusedTransparencyField"
                class="control-field"
                data-help-text="Control how transparent inactive routes appear for climbers."
              >
                <span>Unfocused transparency</span>
                <input
                  id="unfocusedTransparencySlider"
                  type="range"
                  min="0"
                  max="100"
                  step="5"
                  value="25"
                />
              </label>
              <button
                id="saveAppearanceButton"
                class="appearance-save-button"
                type="button"
                data-help-text="Save these appearance defaults for the current wall."
              >
                Save Appearance
              </button>
            </div>
            <div class="control-section">
              <h3 class="control-section-title">Session actions</h3>
              <div class="global-actions">
                <button
                  id="climberViewButton"
                  class="global-action-button"
                  type="button"
                  data-help-text="Open the climber preview using the active wall."
                >
                  <span class="button-label">Climber View</span>
                </button>
                <button
                  id="personalDashboardButton"
                  class="global-action-button"
                  type="button"
                  data-help-text="Jump to your personal dashboard to review ascents and progress."
                >
                  <span class="button-label">Personal Dashboard</span>
                </button>
                <button
                  id="adminConsoleButton"
                  class="global-action-button"
                  type="button"
                  data-help-text="Open the admin console for database management."
                >
                  <span class="button-icon" aria-hidden="true">üõ°Ô∏è</span>
                  <span class="button-label">Admin</span>
                </button>
                <button
                  id="signOutButton"
                  class="global-action-button"
                  type="button"
                  data-help-text="Sign out of the setter tools."
                >
                  <span class="button-icon" aria-hidden="true">üö™</span>
                  <span class="button-label">Sign Out</span>
                </button>
              </div>
              <p
                id="adminConsoleStatus"
                class="status-message hidden"
                role="status"
                aria-live="polite"
              ></p>
            </div>
          </div>
          <div
            id="wallsTab"
            class="tab-panel"
            role="tabpanel"
            aria-labelledby="wallsTabButton"
            aria-hidden="true"
          >
            <div class="control-section">
              <h3 class="control-section-title">Select wall</h3>
              <div class="global-actions">
                <button
                  id="locationButton"
                  class="global-action-button"
                  type="button"
                  aria-haspopup="dialog"
                  aria-expanded="false"
                  data-help-text="Open the wall picker to switch backgrounds."
                >
                  <span class="button-icon" aria-hidden="true">üìç</span>
                  <span class="button-label">Select wall</span>
                </button>
              </div>
              <label
                id="wallVisibilityToggleWrapper"
                class="control-toggle"
                data-help-text="Hide this wall from climber-facing pages so only setters can access it."
              >
                <span>Hide wall from climbers</span>
                <input id="wallVisibilityToggle" type="checkbox" role="switch" aria-checked="false" />
              </label>
            </div>
            <div class="control-section">
              <h3 class="control-section-title">Create new wall</h3>
              <label class="control-field" data-help-text="Name shown in the wall selector for setters and climbers.">
                <span>Wall name</span>
                <input id="newWallNameInput" type="text" placeholder="e.g. Cave Wall" autocomplete="off" />
              </label>
              <label class="control-field" data-help-text="Provide an image path or URL for the wall background.">
                <span>Background image URL</span>
                <input
                  id="newWallImageInput"
                  type="text"
                  placeholder="./location/cave-wall.jpg"
                  autocomplete="off"
                />
              </label>
              <button
                id="createWallButton"
                class="location-button"
                type="button"
                data-help-text="Create a wall using the name and background above."
              >
                <span class="button-icon" aria-hidden="true">üìç</span>
                <span class="button-label">Create wall</span>
              </button>
              <button
                id="deleteWallButton"
                class="location-button delete-wall-button"
                type="button"
                data-help-text="Remove the currently selected wall."
              >
                Delete Wall
              </button>
              <p
                id="createWallStatus"
                class="status-message hidden"
                role="status"
                aria-live="polite"
              ></p>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="unauthorizedNotice" class="unauthorized hidden" role="alert">
    <p><strong>Access denied.</strong> Your account does not have permission to use the setter tools.</p>
    <p>You can return to the <a id="previewLink" href="index.html">preview page</a> or contact a setter for help.</p>
    <button id="unauthorizedSignOut" class="auth-submit" type="button">
      <span class="button-icon" aria-hidden="true">üö™</span>
      <span class="button-label">Sign Out</span>
    </button>
  </div>

  <p id="routeStatus" class="status-message hidden" role="status" aria-live="polite"></p>

  <div
    id="locationModal"
    class="location-modal hidden"
    role="dialog"
    aria-modal="true"
    aria-hidden="true"
    aria-labelledby="locationModalTitle"
  >
    <div class="location-modal-content">
      <div class="location-modal-header">
        <h2 id="locationModalTitle" class="location-modal-title">Select a wall</h2>
        <button id="locationModalClose" class="location-modal-close" type="button" aria-label="Close wall selector">
          √ó
        </button>
      </div>
      <div id="locationOptions" class="location-options" role="listbox"></div>
    </div>
  </div>

  <div
    id="tutorialOverlay"
    class="tutorial-overlay hidden"
    role="dialog"
    aria-modal="true"
    aria-hidden="true"
    aria-labelledby="tutorialTitle"
    aria-describedby="tutorialDescription"
    data-tutorial-exempt="true"
  >
    <div id="tutorialDialogCard" class="tutorial-card" role="document" tabindex="-1">
      <div id="tutorialProgress" class="tutorial-progress hidden" aria-live="polite"></div>
      <h2 id="tutorialTitle" class="tutorial-title"></h2>
      <div id="tutorialDescription" class="tutorial-description"></div>
      <div class="tutorial-actions">
        <button
          id="tutorialSecondaryAction"
          class="tutorial-button tutorial-secondary hidden"
          type="button"
          data-tutorial-exempt="true"
        >
          Back
        </button>
        <button
          id="tutorialPrimaryAction"
          class="tutorial-button tutorial-primary"
          type="button"
          data-tutorial-exempt="true"
        >
          Next
        </button>
      </div>
    </div>
  </div>

  <script defer src="shared/page-loader.js"></script>
  <script type="module" src="setter.js"></script>
</body>
</html>
